<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="public/responsive-1600x720.css">
    <title>Energy Quest: Misteri Hemat Listrik</title>
    <script src="scripts/in-game-notifications.js"></script>
    <link rel="stylesheet" href="public/main-menu.css">
    <link rel="icon" type="image/x-icon" href="public/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="public/globalGameState.js"></script>
    <script src="public/audio-manager.js"></script>
</head>
<body>
    <!-- Background Video -->
    <div id="background-video">
        <video autoplay muted loop>
            <source src="public/Video/video action.mp4" type="video/mp4">
        </video>
        <div class="video-overlay"></div>
    </div>

    <!-- Main Menu Container -->
    <div id="main-menu-container">
        <!-- Header Title -->
        <div class="header-container">
            <img src="public/logo.png" alt="Energy Quest Logo" class="main-logo">
            <div class="title-wrapper">
                <h1 class="game-title-energy">ENERGY</h1>
                <h1 class="game-title-quest">QUEST</h1>
                <!-- Transparent button over Energy Quest text -->
                <button class="transparent-title-btn" onclick="loadSplashScreen()" title="Klik untuk ke Splashscreen"></button>
                <!-- Animated particles around title -->
                <div class="title-particles">
                    <div class="particle"></div>
                    <div class="particle"></div>
                    <div class="particle"></div>
                    <div class="particle"></div>
                    <div class="particle"></div>
                </div>
            </div>
            <p class="game-subtitle">üîã Misteri Hemat Listrik ‚ö°</p>
            <!-- Progress indicator -->
            <div class="global-progress">
                <div class="progress-text">Progress Keseluruhan</div>
                <div class="progress-bar-global">
                    <div class="progress-fill-global" id="global-progress-fill"></div>
                </div>
                <div class="progress-percentage" id="global-progress-text">0%</div>
            </div>
        </div>

        <!-- Top Right Options -->
        <div class="top-options">
            <button class="option-btn small-btn" onclick="loadOpeningAnimation()">
                <i class="fas fa-play-circle"></i>
                <span>OPENING</span>
            </button>
            <button class="option-btn small-btn" onclick="showInstructions()">
                <i class="fas fa-question-circle"></i>
                <span>PETUNJUK</span>
            </button>
            <button class="option-btn small-btn" onclick="showCredits()">
                <i class="fas fa-info-circle"></i>
                <span>KREDIT</span>
            </button>
        </div>

        <!-- Main Game Buttons -->
        <div class="level-menu">
            <!-- Row 1: Main Adventures -->
            <div class="menu-row">
                <button class="unity-btn level-btn main-game-btn compact" data-level="games" onclick="loadMainGame()">
                    <div class="btn-glow"></div>
                    <i class="fas fa-plug btn-icon"></i>
                    <div class="btn-content">
                        <span class="btn-title">PUZZLE LISTRIK</span>
                        <span class="btn-desc">Hubungkan Kabel & Nyalakan Lampu</span>
                    </div>
                </button>
                
                <button class="unity-btn level-btn simcity-btn compact" data-level="simcity" onclick="loadSimCity()">
                    <div class="btn-glow"></div>
                    <i class="fas fa-cube btn-icon"></i>
                    <div class="btn-content">
                        <span class="btn-title">3D ADVENTURE</span>
                        <span class="btn-desc">Petualangan Rumah Hemat Energi</span>
                    </div>
                </button>
            </div>
            
            <!-- Row 2: Quiz & Final Gate -->
            <div class="menu-row">
                <button class="unity-btn level-btn quiz-btn compact" data-level="quiz" onclick="loadQuiz()">
                    <div class="btn-glow"></div>
                    <i class="fas fa-question-circle btn-icon"></i>
                    <div class="btn-content">
                        <span class="btn-title">KUIS ENERGI</span>
                        <span class="btn-desc">Uji Pengetahuan Hemat Listrik</span>
                    </div>
                </button>
                
                <button class="unity-btn level-btn final-gate-btn compact" data-level="final-gate" onclick="loadFinalGate()" id="final-gate-btn">
                    <div class="btn-glow"></div>
                    <i class="fas fa-door-open btn-icon"></i>
                    <div class="btn-content">
                        <span class="btn-title">GERBANG EVALUASI AKHIR</span>
                        <span class="btn-desc">Kumpulkan 4 Kunci Energi</span>
                    </div>
                </button>
            </div>
            
            <!-- Additional Game Modes -->
            <button class="unity-btn level-btn energy-game-btn compact" data-level="energy-game" onclick="loadEnergyGame()" id="energy-game-btn">
                <div class="btn-glow"></div>
                <i class="fas fa-home btn-icon"></i>
                <div class="btn-content">
                    <span class="btn-title">MAP & PUZZLE</span>
                    <span class="btn-desc">Petualangan Top-Down</span>
                </div>
            </button>
            
            <button class="unity-btn level-btn experiments-btn compact" data-level="experiments" onclick="loadExperiments()" id="experiments-btn">
                <div class="btn-glow"></div>
                <i class="fas fa-flask btn-icon"></i>
                <div class="btn-content">
                    <span class="btn-title">ENERGY EXPERIMENTS</span>
                    <span class="btn-desc">Teknologi Energi Masa Depan</span>
                </div>
            </button>
            
            <!-- Testing Button -->
            <button class="unity-btn level-btn testing-btn compact" onclick="unlockAllKeysForTesting()" style="background: linear-gradient(45deg, #ff6b6b, #ee5a24); margin-top: 10px; display: none;">
                <div class="btn-glow"></div>
                <i class="fas fa-key btn-icon"></i>
                <div class="btn-content">
                    <span class="btn-title">TESTING: UNLOCK ALL KEYS</span>
                    <span class="btn-desc">Untuk Testing</span>
                </div>
            </button>
        </div>
    </div>

    <!-- Instructions Modal -->
    <div id="instructions-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('instructions-modal')">&times;</span>
            <h2>Petunjuk Bermain</h2>
            <div class="instructions-content">
                <div class="instruction-item">
                    <h3>üß© Puzzle</h3>
                    <p>Susun kabel listrik dengan benar untuk menghubungkan sumber listrik ke perangkat.</p>
                </div>
                <div class="instruction-item">
                    <h3>üè† Level 1 - Ruang Tamu</h3>
                    <p>Kelola penggunaan energi di ruang tamu dengan mengatur perangkat elektronik.</p>
                </div>
                <div class="instruction-item">
                    <h3>üç≥ Level 2 - Dapur</h3>
                    <p>Optimalkan efisiensi energi di dapur dengan mengatur peralatan masak.</p>
                </div>
                <div class="instruction-item">
                    <h3>üî¨ Level 3 - Lab</h3>
                    <p>Simulasikan penggunaan energi dan hitung biaya listrik bulanan.</p>
                </div>
                <div class="instruction-item">
                    <h3>üìä Level 4 - Evaluasi</h3>
                    <p>Uji pengetahuan Anda tentang hemat energi melalui kuis interaktif.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Credits Modal -->
    <div id="credits-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('credits-modal')">&times;</span>
            <h2>Tim Pengembang</h2>
            <div class="credits-content">
                <div class="credit-item">
                    <h3>Energy Quest</h3>
                    <p>Game Edukasi Hemat Energi</p>
                </div>

                <div class="credit-item">
                    <h3>Tujuan</h3>
                    <p>Meningkatkan kesadaran tentang pentingnya menghemat energi listrik</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio -->
    <audio id="menu-audio" loop>
        <source src="public/menu-music.mp3" type="audio/mpeg">
    </audio>

    <script src="scripts/scene-manager.js"></script>
    <script src="scripts/narrativeSystem.js"></script>
    <script src="scripts/kitchenScene.js"></script>
    <script src="scripts/bedroomScene.js"></script>
    <script src="scripts/main-menu.js"></script>
    
    <script>
        // Enhanced Main Menu with Dynamic Progress
        document.addEventListener('DOMContentLoaded', function() {
            // Simulate progress loading animation
            setTimeout(() => {
                updateGlobalProgress();
            }, 1000);
            
            // Add hover effects to buttons
            const buttons = document.querySelectorAll('.unity-btn');
            buttons.forEach(button => {
                button.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-5px) scale(1.02)';
                    this.style.boxShadow = '0 15px 30px rgba(0,0,0,0.4)';
                });
                
                button.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                    this.style.boxShadow = '0 8px 16px rgba(0,0,0,0.3)';
                });
            });
        });
        
        function updateGlobalProgress() {
            const progressFill = document.getElementById('global-progress-fill');
            const progressText = document.getElementById('global-progress-text');
            
            // Calculate progress based on completed levels (example)
            let completedLevels = 0;
            const totalLevels = 5;
            
            // Check localStorage for completed levels
            if (localStorage.getItem('level1_completed')) completedLevels++;
            if (localStorage.getItem('level2_completed')) completedLevels++;
            if (localStorage.getItem('quiz_completed')) completedLevels++;
            if (localStorage.getItem('experiments_completed')) completedLevels++;
            if (localStorage.getItem('final_gate_unlocked')) completedLevels++;
            
            const percentage = Math.round((completedLevels / totalLevels) * 100);
            
            // Animate progress bar
            setTimeout(() => {
                progressFill.style.width = percentage + '%';
                progressText.textContent = percentage + '%';
            }, 500);
            
            // Add completion effects
            if (percentage === 100) {
                progressFill.style.background = 'linear-gradient(45deg, #00ff00 0%, #32cd32 100%)';
                progressText.textContent = 'üéâ SELESAI! üéâ';
            }
        }
        
        // Enhanced button click effects
        function addClickEffect(element) {
            element.style.transform = 'scale(0.95)';
            setTimeout(() => {
                element.style.transform = 'scale(1)';
            }, 150);
        }
        
        // Override existing functions to add effects
        const originalLoadMainGame = window.loadMainGame;
        window.loadMainGame = function() {
            addClickEffect(event.target.closest('.unity-btn'));
            if (originalLoadMainGame) originalLoadMainGame();
        };
        
        const originalLoadQuiz = window.loadQuiz;
        window.loadQuiz = function() {
            addClickEffect(event.target.closest('.unity-btn'));
            if (originalLoadQuiz) originalLoadQuiz();
        };
        
        const originalLoadExperiments = window.loadExperiments;
        window.loadExperiments = function() {
            addClickEffect(event.target.closest('.unity-btn'));
            if (originalLoadExperiments) originalLoadExperiments();
        };
    </script>
</body>
</html>