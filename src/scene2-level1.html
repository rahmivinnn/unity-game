<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Quest - Level 1: Ruang Tamu (Dasar Listrik)</title>
    <link rel="stylesheet" href="public/main.css">
    <link rel="stylesheet" href="public/scene2-level1.css">
    <link rel="stylesheet" href="public/real-objects.css">
    <link rel="stylesheet" href="public/back-button.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="public/audio-manager.js"></script>
</head>
<body>
    <!-- Scene 2 Level 1: 客厅容器 -->
    <div id="scene2-level1-container">
        <!-- 背景图层 -->
        <div id="living-room-background">
            <img src="../../../Image/living room.png" alt="客厅背景" id="living-room-bg">
        </div>

        <!-- HUD Interface -->
        <div id="level1-hud">
            <!-- Panel Kiri -->
            <div class="left-panel">
                <div class="character-display">
                    <img src="./public/character2.png" alt="Karakter Ilmuwan" class="character-avatar">
                </div>
                <div class="inventory-panel">
                    <h3>🔑 Kunci Energi</h3>
                    <div id="energy-keys-container">
                        <!-- Kunci energi akan ditambahkan secara dinamis -->
                    </div>
                </div>
                <div class="power-status">
                    <h3>⚡ Status Listrik</h3>
                    <div class="power-indicator">
                        <span id="living-room-power-status">❌ Ruang Tamu Mati</span>
                    </div>
                </div>
            </div>

            <!-- Panel Kanan -->
            <div class="right-panel">
                <div class="level-info">
                    <h2>Level 1: Ruang Tamu - Dasar Listrik</h2>
                    <p>🎯 Misi: Hubungkan kabel listrik dan nyalakan lampu untuk menemukan petunjuk ilmuwan yang hilang!</p>
                </div>
                <div class="progress-tracker">
                    <div class="task-item" id="task-cable">
                        <span class="task-icon">🔌</span>
                        <span class="task-text">Hubungkan Kabel Listrik</span>
                        <span class="task-status">⏳</span>
                    </div>
                    <div class="task-item" id="task-tv">
                        <span class="task-icon">📺</span>
                        <span class="task-text">Nyalakan TV untuk Petunjuk</span>
                        <span class="task-status">🔒</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Area Game Utama -->
        <div id="living-room-main">
            <!-- Karakter Pemandu Ilmuwan -->
            <div id="character-guide" class="character-guide">
                <div class="real-scientist-character"></div>
                <div class="character-speech-bubble hidden" id="character-speech">
                    <div class="speech-content">
                        <p id="speech-text">🔍 Selamat datang di rumah misterius! Bantu saya menemukan petunjuk dengan menghubungkan listrik!</p>
                    </div>
                    <div class="speech-arrow"></div>
                </div>
            </div>
            
            <!-- Objek Interaktif -->
            <div class="interactive-objects">
                <!-- Baterai -->
                <div class="interactive-item battery" id="battery-obj" data-object="battery">
                    <div class="object-highlight"></div>
                    <div class="object-label">🔋 Baterai</div>
                    <div class="real-battery"></div>
                </div>

                <!-- Saklar -->
                <div class="interactive-item switch" id="switch-obj" data-object="switch">
                    <div class="object-highlight"></div>
                    <div class="object-label">🔘 Saklar</div>
                    <div class="real-switch"></div>
                </div>

                <!-- Lampu -->
                <div class="interactive-item lamp" id="lamp-obj" data-object="lamp">
                    <div class="object-highlight"></div>
                    <div class="object-label">💡 Lampu</div>
                    <div class="lamp-glow" id="lamp-glow">
                        <div class="real-lightbulb"></div>
                    </div>
                </div>

                <!-- TV -->
                <div class="interactive-item tv" id="tv-obj" data-object="tv">
                    <div class="object-highlight"></div>
                    <div class="object-label">📺 TV Petunjuk</div>
                    <div class="tv-screen" id="tv-screen">
                        <div class="real-tv"></div>
                    </div>
                </div>

                <!-- Area Meja Kabel -->
                <div class="interactive-item cable-table" id="cable-table-obj" data-object="cable_table">
                    <div class="object-highlight"></div>
                    <div class="object-label">🔧 Meja Eksperimen</div>
                    <div class="cable-pieces-preview">
                        <div class="cable-piece"></div>
                        <div class="cable-piece"></div>
                        <div class="cable-piece"></div>
                    </div>
                </div>
            </div>

            <!-- Bubble Petunjuk -->
            <div id="hint-bubble" class="hint-bubble hidden">
                <div class="hint-content">
                    <p id="hint-text"></p>
                    <button id="hint-close">×</button>
                </div>
            </div>
        </div>

        <!-- Puzzle A: Panel Koneksi Listrik -->
        <div id="cable-puzzle-overlay" class="puzzle-overlay hidden">
            <div class="puzzle-panel">
                <div class="puzzle-header">
                    <h3>🔌 Hubungkan Rangkaian Listrik</h3>
                    <button id="cable-puzzle-close" class="close-btn">×</button>
                </div>
                <div class="puzzle-content">
                    <div class="circuit-grid" id="circuit-grid">
                        <!-- Grid Komponen Listrik -->
                        <div class="grid-slot" data-slot="battery-pos" data-type="battery-positive">
                            <div class="slot-label">
                                <div class="real-battery">
                                    <div class="battery-label">Baterai (+)</div>
                                </div>
                            </div>
                        </div>
                        <div class="grid-slot" data-slot="switch" data-type="switch">
                            <div class="slot-label">
                                <div class="real-switch">
                                    <div class="switch-plate">
                                        <div class="switch-toggle"></div>
                                    </div>
                                </div>
                                <div style="margin-top: 5px; font-size: 12px;">Saklar</div>
                            </div>
                        </div>
                        <div class="grid-slot" data-slot="lamp" data-type="lamp">
                            <div class="slot-label">
                                <div class="real-lamp">
                                    <div class="lamp-bulb">
                                        <div class="lamp-filament"></div>
                                    </div>
                                    <div class="lamp-neck"></div>
                                    <div class="lamp-base"></div>
                                </div>
                                <div style="margin-top: 5px; font-size: 12px;">Lampu</div>
                            </div>
                        </div>
                        <div class="grid-slot" data-slot="battery-neg" data-type="battery-negative">
                            <div class="slot-label">
                                <div class="real-battery negative">
                                    <div class="battery-label">Baterai (-)</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="components-area">
                        <h4>🔧 Seret Komponen ke Posisi yang Benar</h4>
                        <div class="draggable-components">
                            <div class="component real-object" data-component="battery-positive" draggable="true">
                                <div class="component-icon">
                                    <div class="real-battery" style="transform: scale(0.7);">
                                        <div class="battery-label">+</div>
                                    </div>
                                </div>
                                <div class="component-label">Kutub Positif</div>
                            </div>
                            <div class="component real-object" data-component="switch" draggable="true">
                                <div class="component-icon">
                                    <div class="real-switch" style="transform: scale(0.7);">
                                        <div class="switch-plate">
                                            <div class="switch-toggle"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="component-label">Saklar</div>
                            </div>
                            <div class="component real-object" data-component="lamp" draggable="true">
                                <div class="component-icon">
                                    <div class="real-lamp" style="transform: scale(0.7);">
                                        <div class="lamp-bulb">
                                            <div class="lamp-filament"></div>
                                        </div>
                                        <div class="lamp-neck"></div>
                                        <div class="lamp-base"></div>
                                    </div>
                                </div>
                                <div class="component-label">Lampu</div>
                            </div>
                            <div class="component real-object" data-component="battery-negative" draggable="true">
                                <div class="component-icon">
                                    <div class="real-battery negative" style="transform: scale(0.7);">
                                        <div class="battery-label">−</div>
                                    </div>
                                </div>
                                <div class="component-label">Kutub Negatif</div>
                            </div>
                        </div>
                    </div>
                    <div class="cable-connections" id="cable-connections">
                        <!-- Kabel koneksi akan digambar secara dinamis -->
                        <svg id="connection-svg" width="100%" height="100%">
                            <!-- Garis koneksi akan ditambahkan melalui JavaScript -->
                        </svg>
                    </div>
                </div>
                <div class="puzzle-controls">
                    <button id="test-circuit" class="puzzle-btn">⚡ Uji Rangkaian</button>
                    <button id="reset-circuit" class="puzzle-btn secondary">🔄 Reset</button>
                </div>
            </div>
        </div>

        <!-- Puzzle B: Panel Kontrol TV -->
        <div id="tv-puzzle-overlay" class="puzzle-overlay hidden">
            <div class="puzzle-panel">
                <div class="puzzle-header">
                    <h3>📺 Nyalakan TV untuk Petunjuk</h3>
                    <button id="tv-puzzle-close" class="close-btn">×</button>
                </div>
                <div class="puzzle-content">
                    <div class="tv-front-panel">
                        <div class="tv-screen-large" id="tv-screen-large">
                            <div class="screen-static" id="screen-static"></div>
                            <div class="screen-content" id="screen-content"></div>
                        </div>
                        <div class="tv-controls">
                            <div class="control-step" data-step="1" id="step-cable">
                                <div class="step-icon">🔌</div>
                                <div class="step-label">插入电源线</div>
                                <div class="step-status">⏳</div>
                            </div>
                            <div class="control-step" data-step="2" id="step-switch">
                                <div class="step-icon">🔘</div>
                                <div class="step-label">打开主开关</div>
                                <div class="step-status">🔒</div>
                            </div>
                            <div class="control-step" data-step="3" id="step-power">
                                <div class="step-icon">⚡</div>
                                <div class="step-label">按电源按钮</div>
                                <div class="step-status">🔒</div>
                            </div>
                            <div class="control-step" data-step="4" id="step-channel">
                                <div class="step-icon">📡</div>
                                <div class="step-label">调整频道</div>
                                <div class="step-status">🔒</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 成功消息面板 -->
        <div id="success-message" class="message-overlay hidden">
            <div class="message-panel">
                <div class="message-content">
                    <div class="success-icon">🎉</div>
                    <h3 id="success-title">恭喜!</h3>
                    <p id="success-text"></p>
                    <div class="reward-display" id="reward-display">
                        <!-- 奖励动画将在这里显示 -->
                    </div>
                </div>
                <button id="success-continue" class="continue-btn">继续</button>
            </div>
        </div>

        <!-- Panel Informasi Edukasi -->
        <div id="educational-popup" class="popup-overlay hidden">
            <div class="popup-panel">
                <div class="popup-header">
                    <h3 id="edu-title">💡 Pengetahuan Listrik</h3>
                    <button id="edu-close" class="close-btn">×</button>
                </div>
                <div class="popup-content">
                    <p id="edu-content"></p>
                    <div class="edu-expand" id="edu-expand">
                        <button id="edu-expand-btn">🔍 Pelajari Lebih Lanjut</button>
                        <div class="edu-detail" id="edu-detail"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 音频元素 -->
    <!-- Background Music -->
    <audio id="background-music" preload="auto" loop>
        <source src="public/audio/background_music.mp3" type="audio/mpeg">
        <source src="public/sound.mp3" type="audio/mpeg">
    </audio>
    
    <!-- Dramatic Sound for Videos -->
    <audio id="dramatic-sound" preload="auto">
        <source src="public/audio/dramatic_sound.mp3" type="audio/mpeg">
        <source src="public/sound.mp3" type="audio/mpeg">
    </audio>
    
    <!-- Game Sound Effects -->
    <audio id="sfx-click-success" preload="auto">
        <source src="public/sounds/success.mp3" type="audio/mpeg">
    </audio>
    <audio id="sfx-buzz" preload="auto">
        <source src="public/sounds/error.mp3" type="audio/mpeg">
    </audio>
    <audio id="sfx-ding" preload="auto">
        <source src="public/sounds/click.mp3" type="audio/mpeg">
    </audio>

    <!-- Back Button -->
    <a href="main-menu.html" class="back-button">
        <i class="fas fa-arrow-left btn-icon"></i>
        <span class="btn-text">Kembali</span>
    </a>

    <!-- JavaScript -->
    <script src="public/globalGameState.js"></script>
    <script src="scripts/narrativeSystem.js"></script>
    <script src="scripts/scene2-level1.js"></script>
</body>
</html>